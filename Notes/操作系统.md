# 1、操作系统（OS）

40 50年代的电脑，每次只能运行一个程序，程序员在打孔纸上写程序，然后再放入计算机中进行计算，一开始计算机速度比较慢，通常一个程序需要运行几天时间，所以放程序的时间还能忍受。但是随着计算机[[运算速度]]的高速发展后，放程序的时间比程序运行时间还要长，我们就需要一种方式，让计算机自动运行，于是诞生了**操作系统（Operation Systems，OS）**

一般是开机第一个启动的程序，有操作硬件的特殊权限，可以运行和管理其他程序

开始于1950年代

第一个操作系统加强了程序加载方式

# 2、批处理

之前只能一次给一个程序，现在可以一次多个程序，当计算机运行完一个程序后，就会自动运行下一个程序，这样就不用浪费时间找下一个程序的纸卡，这称为批处理（Batch Processing）

# 3、外部设备

随着计算机的发展，计算机出现在大学和政府办公室，人们开始分享软件，但是有个问题。在哈佛1号和ENIAC那个时代，计算都是一次性的，程序员只需要给特定一台机器写代码，其中处理器、读卡器和打印机都是已知并且不会改变的。但是随着计算机越来越普遍，计算机配置并不总是相同的，比如计算机可能有相同的CPU但是不同的打印机等等，这样程序员不仅要担心程序，还要担心程序怎么和不同型号的打印机进行交互，以及计算机连着的其他设备，统称为**外部设备（Peripherals）**

和早期的外部设备交互是非常底层的，程序员需要了解设备的硬件细节，但是程序员又很少能拿到所有型号的设备来测试代码。所以一般是阅读手册然后尽可能编写代码

# 4、设备驱动程序

所以为了能够更好地写软件，操作系统就充当软件和硬件之间的媒介。更具体的，操作系统提供API来抽象硬件，叫设备驱动程序（Device Drivers）

这样程序员可以通过标准化机制和输入输出硬件（Input & Output，I/O）进行交互，而无需关注硬件型号以及具体硬件细节

# 5、调度

世界上第一台超级计算机Atlas机器运算非常快，需要一种方式来尽可能利用更多的算力。他们于1962年设计了一个程序叫Atlas Supervisor，使得操作系统不仅能进行批处理，并且通过调度（Scheduling）还能在单个CPU上同时运行几个程序

# 5、多任务处理

使多个程序可以同时运行，在单个CPU上共享时间。操作系统的这种能力称为多任务处理（Multitasking）

但是同时运行多个程序存在一个**问题**，每个程序都会占用一些内存，当切换到另一个程序后，我们不能丢失这些内存中的数据。所以我们给每个程序分配专属[[内存块]]

# 6、虚拟内存

如果一个程序请求更多内存，操作系统就会决定是否同意，如果同意，就要决定分配哪些内存块，这就使得程序A可能会分配到非连续的内存块，使得程序员能难进行跟踪。

为了隐藏这种复杂性，操作系统会把内存地址进行虚拟化，称为**虚拟内存（Virtual Memory）**。程序可以假定内存总是从地址0开始，而实际的物理位置，被操作系统隐藏和抽象了。以程序B为例，它分配了内存地址1000到1999，但是对于程序B而言，它能看到的地址是0到999，操作系统会自动处理虚拟内存和物理内存之间的映射，所以程序B要地址42，实际需要物理地址1042。对于程序A，它被分配了分散的[[物理内存块]]，但是程序A并不知道，它所能看到的是连续的从0到1999的地址，当程序A读内存地址999时，会被映射到[[物理地址]]999，而当程序A读内存地址1000，则会被[[映射]]到物理地址2000。

# 7、动态内存分配

这种机制使得程序的内存大小可以灵活增减，称为[[动态内存分配]]（Dynamic Memory Allocation）。对程序而言，内存看起来是连续的，为操作系统同时运行多个程序提供了极大的灵活性，程序员只需要根据连续的虚拟内存地址进行编程，无需考虑程序在实际[[物理内存]]中不连续的物理内存块。

# 8、内存保护

同时给每个程序分配一个专用的内存块，可以使得隔离起来更方便。如果一个程序出错了，在内存中胡乱写数据，它只能在自己分配的内存块中进行操作，不会影响到其他程序的数据，这个称为[[内存保护]]（Memory Protection）。这对于防止[[恶意软件]]十分有效

Atlas是第一台提供虚拟内存和内存保护功能的操作系统

# 9、多用户分时操作系统

到1970年代，大学会购买电脑给学生使用，此时计算机不仅能同时运行多个程序，还能让多个用户同时访问。多个用户使用终端（Terminal）来访问计算机，这里的终端只有键盘和屏幕，然后连接到计算机，终端本身并不具有处理能力。

这样计算机不仅要能处理多个程序，还要处理多个用户，为了确保其中一人不会占满计算机资源，开发了分时操作系统（Time-Sharing），指的是每个用户只能用一小部分处理器、内存等，因为计算机很快，所以即使只有一小部分资源，也足以完成很多任务。

早期分时操作系统中，最有影响力的是1969年发布的Multics，它是第一个从设计时就考虑到安全性的操作系统。开发人员不希望恶意用户访问不该访问的数据，这使得操作系统的复杂度远超当时的平均水平，通常内存的一半都要用来运行操作系统，这种过度设计使得Multics未能获得商业成功

# 10、Unix

操作系统分成两部分：

1. 操作系统的核心功能，比如[[内存管理]]，多任务和输入输出处理，这个称为[[内核]]（Kernel）
2. 一些有用的工具，但是他们不是内核的一部分，比如程序和[[运行库]]

紧凑的内核意味着功能没有之前那么全面。当内核出现崩溃时，Multics有很多操作来进行恢复，但是Unix是没有办法恢复的，会直接调用一个panic函数，最初只能无限循环打印panic。这种简单性意味着Unix可以再更便宜的硬件上运行

1971年发布之后，就有人写了不同编程语言的编译器，甚至[[文字处理器]]，使得Unix迅速成为1970-80年代最流行的操作系统之一

# 11、MS-DOS

到1980年代早期，个人电脑逐渐出现，这些电脑比大型主机简单很多，主机一般在大学、公司和政府，因此操作系统也要变得简单。于1981年微软发布的磁盘操作系统MS-DOS只有160kb，虽然缺少多任务和保护内存这样的功能，意味着程序经常使系统崩溃，用户可以直接重启。即使在1985年发布的早期windos，也一样缺少内存保护功能，当程序错误时，就会出现蓝屏

现代的操作系统包含了多任务、虚拟内存和[[内存保护机制]]，因此可以同时运行多个程序
